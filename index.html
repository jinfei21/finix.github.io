<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="baidu-site-verification" content="bp96XM9824" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="金飞的个人博客" type="application/atom+xml" />






<meta name="description" content="简单靠谱，追求自由">
<meta name="keywords" content="哲学 佛学 互联网">
<meta property="og:type" content="website">
<meta property="og:title" content="金飞的个人博客">
<meta property="og:url" content="https://jinfei21.github.io/index.html">
<meta property="og:site_name" content="金飞的个人博客">
<meta property="og:description" content="简单靠谱，追求自由">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="金飞的个人博客">
<meta name="twitter:description" content="简单靠谱，追求自由">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'QN439VZMB2',
      apiKey: '63906b89df659ea85cc99cec233a375d',
      indexName: 'myblog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://jinfei21.github.io/"/>





  <title>金飞的个人博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">金飞的个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">上善若水，知行合一</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jinfei21.github.io/2018/11/15/我为什么看好新一代微服务ServiceMesh/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="费永军">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金飞的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/15/我为什么看好新一代微服务ServiceMesh/" itemprop="url">我为什么看好新一代微服务ServiceMesh</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-15T19:23:11+08:00">
                2018-11-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&emsp;&emsp;前段时间前老大发了一篇文章说不看好servicemesh，我个人不是很赞同这个观点。哲学上有句话说不是我们的认知能力要如实的反映认知对象，而是认知对象要符合我们的认知能力。观点的不同取决于你看问题的视角，没有孰是孰非。来公司也有一年多快两年时间了，过去一直在做微服务体系架构方面的工作。微服务也是近几年兴起的一门新技术，我首次接触微服务还是在携程的时候。2014年微服务处于萌芽期，2015年成为热点，2016年基本普及了。现在传统企业慢慢转向微服务技术栈也是大势所趋，直到最近2017年初出现了对微服务的反思，从而产生了新一代微服务技术ServiceMesh。今天就从个人视角聊聊ServiceMesh的产品思路究竟有何可取之处。谈一件事仅从一个孤立的事件是没法说清问题的，得通过趋势放大时间维度才能看清。</p>
<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><h3 id="什么是ServiceMesh"><a href="#什么是ServiceMesh" class="headerlink" title="什么是ServiceMesh"></a>什么是ServiceMesh</h3><p>&emsp;&emsp;这是一个新词最早由开发Linkerd的Buoyant公司提出，2016年9月第一次公开使用这个术语。在2017年初的随着Linkerd的传入，ServiceMesh才开始进入国内技术圈的视野，最早被翻译为“服务啮合层”，由于比较拗口之后改成了“服务网格”。<br>&emsp;&emsp;那到底什么是ServiceMesh呢？Linkerd的CEO William是这样定义的：</p>
<blockquote>
<p>服务网格是一个基础设施层，功能在于处理服务间通信，职责是负责实现请求的可靠传递。在实践中，服务网格通常实现为轻量级网络代理，通常与应用程序部署在一起，但是对应用程序透明。</p>
</blockquote>
<p>&emsp;&emsp;单纯的文字太抽象，还是通过下图来说明一下：<br><img src="/2018/11/15/我为什么看好新一代微服务ServiceMesh/新一代微服务ServiceMesh演化之路/servicemesh定义.png" alt=""><br>&emsp;&emsp;从上图的部署模型上看，对于单个请求而言，作为请求发起者的客户端实例会首先采用简单方式将请求发送到本地的ServiceMesh实例上，客户端应用实例和ServiceMesh实例是两个独立的进程，他们之间的调用是远程调用。ServiceMesh会把客户端请求路由到目标服务，这时的ServiceMesh承担着服务发现和负载均衡的角色，就像一个边车sidecar。我们来看它和传统微服务调用有什么不同？<br><img src="/2018/11/15/我为什么看好新一代微服务ServiceMesh/新一代微服务ServiceMesh演化之路/servicemesh对比.png" alt=""><br>&emsp;&emsp;初看ServiceMesh好像就是在客户端和服务端之间多加了层代理而已，也不是什么新的东西。这是仅从单个服务之间调用的视角看，如果从多个服务调用视角看：<br><img src="/2018/11/15/我为什么看好新一代微服务ServiceMesh/新一代微服务ServiceMesh演化之路/servicemesh网格.png" alt=""><br>&emsp;&emsp;多个服务调用的情况，从上图我们可以看到ServiceMesh在所有服务的下面，这一层被称为服务间通讯专用基础设施层。ServiceMesh会接管整个网络，把所有请求在服务之间做转发。这样上面的服务就不在担负传递请求的具体逻辑了，只专注完成业务逻辑，服务之间的通讯环节就从应用层剥离出来，呈现一个抽象层。如果有大量的服务，就会表现出如下所示的网格来，这时候代理体现出来就和前面的有点不一样了，而是形成一个网状结构。<br><img src="/2018/11/15/我为什么看好新一代微服务ServiceMesh/新一代微服务ServiceMesh演化之路/sidecar.png" alt=""><br>&emsp;&emsp;总结一下，服务网格实际上是抽象出了一个基础设施层，独立于应用之外，所提供的功能就是实现请求的可靠路由，部署上体现为轻量级的网络代理，并对应用是透明的。</p>
<h3 id="ServiceMesh的演化过程"><a href="#ServiceMesh的演化过程" class="headerlink" title="ServiceMesh的演化过程"></a>ServiceMesh的演化过程</h3><p>&emsp;&emsp;在第一代网络计算机系统时代，那时的程序猿需要在自己的代码中添加网络通讯的细节问题，例如数据包顺序，流控等等，导致网络逻辑和业务逻辑混杂在一起。后来为了改进这一问题才出现了TCP/IP技术，解决了流控和数据包顺序问题，从下图可以看出，网络最重要的流控逻辑已经从应用逻辑中剥离开了，剥离出来的东西成了操作系统网络层的一部分。<br><img src="/2018/11/15/我为什么看好新一代微服务ServiceMesh/新一代微服务ServiceMesh演化之路/原始阶段.png" alt=""><br>&emsp;&emsp;自从有了TCP/IP技术，写代码再也不用考虑网卡怎么发了，这件事大概发生在五十多年前。虽然不用考虑网卡数据包相关的问题了，但是随着服务数的增多，所面临的挑战也很多，比如服务注册、服务发现、负载均衡等等，这些问题都需要考虑。<br><img src="/2018/11/15/我为什么看好新一代微服务ServiceMesh/新一代微服务ServiceMesh演化之路/微服务时代.png" alt=""><br>&emsp;&emsp;如上图所示，左边的是微服务时代第一版处理问题的方式，业务逻辑和熔断限流服务注册与发现等非业务逻辑混杂在一起。为了简化开发，人们开始把这些和业务无关的逻辑封装成类库，比如典型的Netflix OSS套件。这样开发人员只需要写少量的代码或注解，就能实现这些功能，极大缓解了程序猿们的业务压力。<br>&emsp;&emsp;但是凡事有利有弊，这样虽然解决了一部分问题，同时也会带来新的问题。Netflix把每个通用的功能封装成一个个基础套件形成了一系列产品，比如像eureka、hystrix、feign、archiaus以及ribbon等等。开发人员是不需要开发非业务相关的代码了，也要花费相当的时间熟悉其中的原理，否则一旦出现问题就没法解决了。对业务团队的人来说，擅长的往往是对业务的理解而不是技术，实现业务是业务开发人员的核心价值，微服务是手段而不是目标。业务开发人员花相当多的精力学习这些和业务无关的框架是得不偿失的。相反比学习微服务框架更大的挑战是微服务拆分、API设计、数据一致性、康威定律。<br>&emsp;&emsp;微服务时代面临最大的挑战就是服务治理，特别是现在是一个云原生的时代，服务治理就显得尤其关键。但是Netflix OSS套件提供的服务治理功能十分粗糙不够强大。下图列举了一些服务治理常用的功能列表：<br><img src="/2018/11/15/我为什么看好新一代微服务ServiceMesh/新一代微服务ServiceMesh演化之路/服务治理.png" alt=""><br>&emsp;&emsp;封装成类库带来的另一个问题就是跨语言。微服务在刚开始面世时就承诺了一个很重要的特性：不同微服务可以采用最适合的语言来编写，也就是微服务之间能实现跨语言的调用。如果是用类库的方式来实现，意味着所有的语言你都得实现一遍，提供不同语言的类库版本，要考虑各个语言之间的类型转换等等。还有类库版本兼容问题都要考虑，更加严峻的现实是类库版本升级将是灾难。<br>&emsp;&emsp;因此基于以上这些情况，我们可以反思一下微服务的问题到底出在哪里？</p>
<blockquote>
<p>1.上面我们都在谈问题和挑战，好像没有说服务本身。问题的根源就是要解决服务通讯和路由，这才是微服务框架需要解决的问题。<br>2.上面所有的努力都是为了将客户端请求路由到挣钱的地方，比如有版本差异，需不需要做负载均衡，要不要做灰度，最终这些考虑都是为了将请求发送到正确的目的地址。<br>3.服务之间的调用请求，这个请求本身在传递过程中不会发生更改，而且这个请求能被不同的语言框架识别。</p>
</blockquote>
<p>&emsp;&emsp;类比以前的TCP/IP协议栈技术，它要解决的问题将请求发送到正确的地方。有了TCP/IP技术，应用开发就不用关心TCP层下的链路实现了。因此为什么现在开发微服务应用时要这么关心服务的通讯层呢？这种情况下自然产生一个想法，是否可以把微服务和通讯相关的下层为网络栈协议，也就是理想状态就是在网络协议层中添加一个微服务应用层来完成整个事情。虽然现在因为标准问题，实现起来不现实，但是不排除未来会出现一个微服务网络层。目前主流的方案在代理的基础上添加完善的治理功能，产生了由所谓数据平面和控制平面构成的ServiceMesh解决方案。目前开源社区里最热门的ServiceMesh产品是Istio。</p>
<h2 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h2><p>&emsp;&emsp;到此就介绍完ServiceMesh的演进过程了，虽然目前ServiceMesh方兴未艾，各个开源产品都在持续迭代中，同时也有不少质疑的声音，例如我的前老大，但是我还是非常看好ServiceMesh的发展前景。通过技术栈的下移，确实解决了不少问题。开发人员有了ServiceMesh以后，不用关注那么多插件的使用方式和原理了，只需关注应用本身的业务逻辑，ServiceMesh会把治理功能做强做大，它会解决跨语言跨协议的调用，ServiceMesh如果要升级对应用都是透明无感知的。有了ServiceMesh以后，客户端和服务端都极其简化，客户端只需要向ServiceMesh发出请求即可，会少很多类库依赖，这样减少了jar包冲突的风险，而服务端只要做一件事件就是服务注册。<br>&emsp;&emsp;ServiceMesh不仅方便了开发人员，对运维管理也将是革命性的变化。如果有了ServiceMesh的治理功能，运维对系统的管理和控制力也会空前强大，很多运维工作都可以通过可视化的控制平面完成。<br>&emsp;&emsp;ServiceMesh解决跨语言的问题，给许多新兴小众语言也带来利好。对于语言选择来说，最重要的就是生态，由于java语言生态丰富，有很多完善的类库和框架，导致开发java应用会非常快速便捷。因此现在市场上java程序员机会就比其它的多，像我这种原先鄙视java的都不得不从c++转到java上来。有了ServiceMesh以后，小众语言就可以避开这个弊端，不必和java比拼生态，而是发挥各自语言的优势。<br>&emsp;&emsp;最后放一张Istio的架构图结束全文，让我们全面拥抱新一代微服务ServiceMesh！<br><img src="/2018/11/15/我为什么看好新一代微服务ServiceMesh/新一代微服务ServiceMesh演化之路/Istio.jpg" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jinfei21.github.io/2018/11/10/人生如戏，戏如人生/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="费永军">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金飞的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/10/人生如戏，戏如人生/" itemprop="url">人生如戏，戏如人生</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-10T14:27:20+08:00">
                2018-11-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/杂说/" itemprop="url" rel="index">
                    <span itemprop="name">杂说</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;本月11月3日，香港著名演员蓝洁瑛被发现死在自己的公寓里，相比她曾经靓绝五台山的辉煌过去，和她去世时的凄凉形成了鲜明反差，网络上许多网友不约而同的发出了红颜薄命的感叹。关于她演的电视剧和电影，我印象比较深的就是《大时代》和《大话西游》。她人生最后阶段竟如大时代她所饰演的玲姐一样让人觉得悲伤和凄凉。2018年去世了不少知名的人物，像李咏、金庸、单田方、李敖等，这些人物在人生最后阶段都是比较幸福的，正应了一句话幸福的人都是相似的，不幸的人各有各的不幸。<br>&emsp;&emsp;1963年，蓝洁瑛出生在一个普通的香港家庭，由于父亲重男轻女，在她年幼的时候，她的亲生父亲抛弃了他们母女，为了生存她母亲带着她改嫁，可惜继父是个有暴力倾向的人，经常打骂幼年的她，说她是拖油瓶。在这种环境下长大的蓝洁瑛，也养成了她比较倔强的性格，她渴望被人爱。或许凄惨的童年给她以后的人生定下了基调，若是没有走进娱乐圈，走其它不靠美色谋生的道路，或许人生又会是别的模样。<br>&emsp;&emsp;1983年，年仅20岁的蓝洁瑛陪同好友去报考无线培训班，不巧的是那天好友有事去不了，她去了而且被选中，成了无线电视艺员训练班的第12期学员。同批的学员都是当今的大腕，例如刘嘉玲、吴君如和刘青云。最初无线高层也十分看好她，让她做主持人和演电视剧。可惜她固执的性格，阻断了她成名路。进入无线后，当时她正当红，公司想和她续约，结果她拒绝了，导致无线高层震怒把她雪藏了。身在娱乐圈的她，要谋生却不懂低头屈服于潜规则，遇到不喜欢的人和事也不懂变通。奈何蓝洁瑛市场呼声太高，雪藏复出拍戏的她还是不懂得低头，而这时的香港娱乐圈也是新人辈出，她的名气也大不如前了。<br>&emsp;&emsp;事业上蓝洁瑛不算成功，情场上也一波三折。她经历了2任男友，第一任是邓姓乡绅的儿子，热恋中的他却忽然开煤气自杀了。第二任是当时香港当红DJ钟保罗，可惜钟好赌，而且赌的都挺大的，赚的钱都不够还债的，蓝洁瑛也帮着一起还债，债务快还清的时候，钟却选择跳楼自杀了。这前后不到3年的时间，2任男友接连离去，给她的心理留下了挥之不去的阴影。<br>&emsp;&emsp;在1990年，媒体上爆料说：蓝洁瑛患有精神病遭到公司的雪藏。随着时间流逝，事实真相也浮出水面，原来她是遭遇到了香港娱乐大佬的性侵，这些遭遇给她留下了无法愈合的心理创伤，从而导致了她精神失常。当年刘嘉玲事件也闹得沸沸扬扬，刘嘉玲选择了勇敢走出来，而她选择了沉默没有报警。对于香港娱乐圈的黑暗，这位绝代风华的美人遭遇的不公和一生的痛楚，但凡有点同情心的都会随之动容。性侵事件遭媒体曝光后，不断有圈内人士向媒体爆料说蓝洁瑛的人品有问题。到如今，真相还未大白，斯人已离我们而去。。。。<br>&emsp;&emsp;蓝洁瑛长的那么美，在这个新的时代理应过得很好，她的人生本该是明朗顺遂，无奈前路却是一连串的暴风雪。在事业如日中天时，突然精神失常从此落寂和消沉，流浪街头，疾病缠身无人问，被媒体嘲讽为疯婆子。她这些年的境遇竟然在她饰演的《大时代》中的玲姐得到了很好的诠释。《大时代》是难得的对香港弱肉强食的资本社会控诉和质疑的电视剧，而在剧中承担控诉和质疑使命的，恰恰是一直被损害被逼迫，但也一直没有投降的玲姐。玲姐有个凄美的结局，在飞扬的像雪一样的泡沫粒子中，在和丁蟹完成了一番厮打之后，神智恢复了正常的她艰难的找到自己那枚20块钱的戒指，然后丢掉丁蟹的绿宝石戒指，用尽最后一丝力气把这枚象征着她一生为数不多的温暖时刻的戒指戴到手指上，然后面带微笑的死去，这时的背景音乐是王菲的《容易受伤的女人》，音乐加上剧情很奇异的产生了巨大的宿命感。<br>&emsp;&emsp;香港我今年5月份去过，实地体验了香港社会的氛围。在香港近百年的殖民统治，形成了香港人顺从的奴性，特别是越底层我的感受越明显。在高效而傲慢运转着的香港资本社会，依然源源不断地产出着因为三从四德、懂事隐忍成为豪门阔太的夸张故事，「不配合」和「不顺从」常常成为触发命运走向的那个关键开关。蓝洁瑛的「不顺从」成为这种隐秘逻辑的最佳反例，成为教育后来人的那个活灵活现的「下场」。香港媒体热衷记录蓝洁瑛的窘迫，不管是臃肿的身材，涣散的眼神，廉价的人字拖，灰白杂乱的头发，还是当众的精神失常，鬼鬼神神的言语，都是这「下场」的一部分。人们对蓝洁瑛的窥伺隐含了长久以来笑贫不笑娼的残忍逻辑，也满足了大多数人「只要有人比我过得更惨，我就不觉得自己的日子过得多差」的冷酷现实。<br>&emsp;&emsp;「玲姐」比蓝洁瑛幸运的是，在生命的尽头处，她拿出剪刀、西餐刀，抢过冲上来的警察的枪，不顾一切地冲向丁蟹，冲向这个制造了自己一生噩梦的男人，也冲向从不肯怜悯她、从没给过她一丝善意的命运，她决心不再忍受，一定要彻底地反抗、彻底地报复。很可惜，这样孤注一掷的痛快，没有出现在蓝洁瑛的生命中。<br>&emsp;&emsp;稍稍解脱和幸运的是，所有爱她、疼惜她的人唯一可以拿来自我安慰的是，这大约是蓝洁瑛最后一次上热搜和头条了，被围观，被窥伺，被损害，大概都是最后一次了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jinfei21.github.io/2018/10/30/浅谈深度学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="费永军">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金飞的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/30/浅谈深度学习/" itemprop="url">浅谈深度学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-30T11:13:05+08:00">
                2018-10-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&emsp;&emsp;研究生学的是数据挖掘，搞过一段时间的BP神经网络，当年为了发表论文，硬着头皮推导了三个月的梯度下降算法才从数学原理上搞明白，后来还用c语言实现了一版。也正是因为这段痛苦的经历，后面放弃继续深入研究下去。最近这几年随着TensorFlow热门起来，机器学习发展到深度学习，人工智能越来越热门了，现在不了解点人工智能的东西都不好意思说在IT界混了。当年学习机器学习时，深度学习还没有出来。最近我也一直断断续续的在学习这块内容，这期就简单聊一下深度学习，去掉复杂繁琐的数学公式推导，让大家对深度学习有个基本概念。</p>
<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>&emsp;&emsp;20世纪80年代末期，人工神经网络的反向传播算法（也叫Back Propagation算法或者BP算法）的发明，给机器学习带来了希望，掀起了基于统计模型的机器学习热潮。一个基本的神经网络模型如下图所示：<br><img src="/2018/10/30/浅谈深度学习/BP神经网络.jpg" alt=""><br>&emsp;&emsp;上图中每个圆圈都是一个神经元，每条线表示神经元之间的连接。可以看到，神经元被分了多层，层与层之间的神经元有连接，而层内之间的神经元没有连接。最左边的是输入层，负责接收输入数据。最右边是输出层，负责输出最终结果。输入层和输出层之间的层叫做隐藏层。<br>&emsp;&emsp;隐藏层大于2层的神经网络叫做深度神经网络，而<em>深度学习</em>就是使用深层架构（比如，深度神经网络）的机器学习方法。深层网络和浅层网络相比，深层网络表达力更强。事实上，一个仅有一个隐藏层的神经网络能拟合任何一个函数，但是有一个缺点就是浅层网络需要更多的神经元。而深层网络可以用少的多的神经元拟合同样的函数，不过深层网络也有缺点，就是它不太容易训练收敛。简单的说，就是训练好一个深层神经网络往往需要大量的数据和技巧。<br>&emsp;&emsp;从上图中可以看到，构成神经网络的基本单位就是一个个神经元，那什么是神经元呢？神经元也叫感知器，在上个世纪50-70年代很流行，也解决过很多实际的问题，并且感知器的算法也很简单，请看下图：<br><img src="/2018/10/30/浅谈深度学习/神经元.png" alt=""><br>&emsp;&emsp;可以看到，一个感知器有如下组成部分：<br><img src="/2018/10/30/浅谈深度学习/神经元组成部分.png" alt=""><br>&emsp;&emsp;了解了神经网络的结构，那么如何训练神经网络呢？训练神经网络实际上就是参数W取什么值最优。一般来说，根据训练样本的不同可以分为两类机器学习方法。</p>
<blockquote>
<ul>
<li>监督学习：这种训练方法要求提供的训练样本既要包含输入特征X，也要包含对应的输出Y。比如我们知道一些人的工作年限，工作职级，所在行业，也知道他们对应的收入。我们就可以用这样的样本去训练模型，让模型既看到我们提出的问题（输入特征x），也看到对应问题的答案（标记y）。当模型看到足够多的样本后，它就能总结出其中的规律，然后就可以预测那些它没有看过的输入所对应的答案了。</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>无监督学习：这种训练方法要求提供的样本可以只有x没有y。模型可以总结出特征x的一些规律，但是无法知道其对应的答案。这种方法一般用在聚类分析上，比如语音识别领域，先让模型总结出那些音节是相似的，然后再用少量带有标注的训练样本，告诉模型其中一些音节对应的文字，这样模型就能把相似音节都对应到相应文字上，从而完成模型的训练。</li>
</ul>
</blockquote>
<p>&emsp;&emsp;先只考虑监督学习，在监督学习下，对于一个样本，我们知道它的特征x，以及标记y。同时，我们还可以根据模型h(x)计算得到输出y’。注意这里面我们用表示训练样本里面的标记，也就是实际值；用带上’的表示模型计算的出来的预测值。模型计算出来的预测值和实际值越接近越好。最后问题就演变成求所有单个样本误差总和函数的最小值，如果能找到一组W能满足这个目标，那就是模型的最终结果。<br>&emsp;&emsp;大学时我们学过怎样求函数的极值。函数的极值点，就是它的导数的那个点。因此我们可以通过解方程(所有单个样本误差总和函数)，求得函数的极值点。不过对于计算机来说，它可不会解方程。但是它可以凭借强大的计算能力，一步一步的去把函数的极值点『试』出来。如下图所示：<br><img src="/2018/10/30/浅谈深度学习/梯度下降.jpg" alt=""><br>&emsp;&emsp;首先随便选择一个点开始，比如上图x0的点。接下来，每次迭代修改x的为x1,x2,x3,…，经过数次迭代后最终达到函数最小值点。现在的问题关键是如何修改x，保证能往函数最小值那个方向前进？这里就用上大学学到的梯度概念了，翻开大学高数课的课本，我们会发现梯度是一个向量，它指向函数值上升最快的方向。显然，梯度的反方向当然就是函数值下降最快的方向了。我们每次沿着梯度相反方向去修改的值，当然就能走到函数的最小值附近。之所以是最小值附近而不是最小值那个点，是因为我们每次移动的步长不会那么恰到好处，有可能最后一次迭代走远了越过了最小值那个点。步长的选择是门手艺，如果选择小了，那么就会迭代很多轮才能走到最小值附近；如果选择大了，那可能就会越过最小值很远，收敛不到一个好的点上。</p>
<p>&emsp;&emsp;现在，我们需要知道一个神经网络的每个连接上的权值是如何得到的。我们可以说神经网络是一个模型，那么这些权值就是模型的参数，也就是模型要学习的东西。然而，一个神经网络的连接方式、网络的层数、每层的节点数这些参数，则不是学习出来的，而是人为事先设置的。对于这些人为设置的参数，我们称之为超参数(Hyper-Parameters)。这些超参数的不同，则对应不同的模型，下面介绍几种常见的网络模型：</p>
<h3 id="全连接神经网络"><a href="#全连接神经网络" class="headerlink" title="全连接神经网络"></a>全连接神经网络</h3><p><img src="/2018/10/30/浅谈深度学习/全连接神经网络.jpg" alt=""><br>&emsp;&emsp;这种网络在使用反向传播算法进行梯度计算时，可能导致梯度消失的问题。不太适合图形识别这样的应用领域，原因主要是以下几个：</p>
<blockquote>
<ul>
<li><em>参数数量太多</em> ：可以考虑输入1000*1000像素的图片，输入层得有1000x1000=100万节点。如果只有一个100个节点的隐藏层，那么隐藏层就需要（1000x1000+1）x100 = 1亿参数，这实在太大了，因此扩展性非常差。</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><em>没有利用像素之间的位置信息</em> ：对于图像识别任务来说，每个像素和其周围像素的联系是比较紧密的，和离得较远的像素联系可能就小的多。如果一个神经元和上一层所有的神经元相连，那么就相当于对于一个像素来说，把图像的所有像素都同等对待了，这不符合前面的要求。每次学习完连接权重后，最终可能发现很多权重的值很小，努力学习不重要的权重，这样的学习效率非常低。</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><em>网络层数限制</em> ：网络层数越多其表达能力越强，同时通过梯度下降算法达到权重收敛的难度也会越来越大，因为全连接神经网络的梯度很难传递超过3层。</li>
</ul>
</blockquote>
<h3 id="卷积神经网络"><a href="#卷积神经网络" class="headerlink" title="卷积神经网络"></a>卷积神经网络</h3><p>&emsp;&emsp;由于全连接网络的诸多缺点，后来的计算机科学家想了很多办法解决这些问题，归纳下来主要有三个思路：</p>
<blockquote>
<ul>
<li><em>局部连接</em> ： 每个神经元不再和上一层的所有神经元相连，只和一部分神经元相连，这样就减少了很多参数。</li>
<li><em>权值共享</em> ：一组连接可以共享同一权重，而不是每个连接都有不同权重，这样也减少了很多参数。</li>
<li><em>下采样</em>  ：使用Pooling（取最大值，最小值，平均值）来减少每层的样本数，进一步减少参数数量，同时还可以提升模型的鲁棒性。</li>
</ul>
</blockquote>
<p>&emsp;&emsp;下图就是一个典型的卷积神经网络：<br><img src="/2018/10/30/浅谈深度学习/卷积神经网络.jpg" alt=""><br>&emsp;&emsp;一个卷积神经网络由若干卷积层、Pooling层、全连接层组成。你可以构建各种不同的卷积神经网络，它的常用架构模式为N个卷积层叠加，然后(可选)叠加一个Pooling层，重复这个结构M次，最后叠加K个全连接层。</p>
<p>&emsp;&emsp;从图中可以发现卷积神经网络的层结构和全连接神经网络的层结构有很大不同。全连接神经网络每层的神经元是按照一维排列的，也就是排成一条线的样子；而卷积神经网络每层的神经元是按照三维排列的，也就是排成一个长方体的样子，有宽度、高度和深度。<br>&emsp;&emsp;对于图中展示的神经网络，我们看到输入层的宽度和高度对应于输入图像的宽度和高度，而它的深度为1。接着，第一个卷积层对这幅图像进行了卷积操作，得到了三个Feature Map。这里的”3”可能是让很多初学者迷惑的地方，实际上，就是这个卷积层包含三个Filter，也就是三套参数，每个Filter都可以把原始输入图像卷积得到一个Feature Map，三个Filter就可以得到三个Feature Map。至于一个卷积层可以有多少个Filter，那是可以自由设定的。也就是说，卷积层的Filter个数也是一个超参数。我们可以把Feature Map可以看做是通过卷积变换提取到的图像特征，三个Filter就对原始图像提取出三组不同的特征，也就是得到了三个Feature Map，也称做三个通道(channel)。<br>&emsp;&emsp;继续观察图，在第一个卷积层之后，Pooling层对三个Feature Map做了下采样(后面我们会讲如何计算下采样)，得到了三个更小的Feature Map。接着，是第二个卷积层，它有5个Filter。每个Fitler都把前面下采样之后的3个<strong>Feature Map卷积在一起，得到一个新的Feature Map。这样，5个Filter就得到了5个Feature Map。接着，是第二个Pooling，继续对5个Feature Map进行下采样</strong>，得到了5个更小的Feature Map。<br>&emsp;&emsp;下图就是很形象的展示了这一计算过程：<br><img src="/2018/10/30/浅谈深度学习/卷积神经网络计算.gif" alt=""></p>
<h3 id="循环神经网络"><a href="#循环神经网络" class="headerlink" title="循环神经网络"></a>循环神经网络</h3><p>&emsp;&emsp;通过介绍前面两种模型，可以发现不管哪种模型都往往只能解决某一类问题，不能解决所有问题，这也是很多深度学习门外汉不了解的。前面两种网络模型，他们都只能单独的去处理一个个的输入，前一个输入和后一个输入完全没有关系。但是实际上往往有些任务之间是有关系的，比如当我们在理解一句话意思时，孤立的理解这句话的每个词是不够的，有时需要处理这些词连接起来的整个序列；当我们处理视频的时候，也不能只单独的去分析每一帧，而要分析这些帧连接起来的整个序列。这时就需要用到深度学习领域中另一类非常重要神经网络：循环神经网络(Recurrent Neural Network)。RNN种类很多，也比较绕脑子。<br>&emsp;&emsp;下图是一个简单的循环神经网络如，它由输入层、一个隐藏层和一个输出层组成：<br><img src="/2018/10/30/浅谈深度学习/循环神经网络.jpg" alt=""><br>&emsp;&emsp;循环神经网络比较抽象，难以图示表达。单纯从上图看，如果去掉W哪个带箭头的圈，它就变成一个普通的全连接神经网络了。那多出来的W是什么呢？循环神经网络的隐藏层的值s不仅仅取决于当前这次的输入x，还取决于上一次隐藏层的值s。权重矩阵W就是隐藏层上一次的值作为这一次的输入权重。<br>&emsp;&emsp;如果我们把上面的图展开，循环神经网络也可以画成下面这个样子：<br><img src="/2018/10/30/浅谈深度学习/循环神经网络时刻.jpg" alt=""><br>&emsp;&emsp;现在看上去就比较清楚了，这个网络在t时刻接收到输入Xt之后，隐藏层的值是St，输出值是Ot。关键一点是，St的值不仅仅取决于Xt，还取决于上一时刻的St-1。<br>&emsp;&emsp;对于语言模型来说，很多时候不仅要看前面的输入，也要看后面的输入，比如下面这句话：<br>我的手机坏了，我打算____一部新手机。<br>&emsp;&emsp;如果我们只看横线前面的词，手机坏了，那么是打算修一修？或是换一部新的？还是大哭一场？这些都是无法确定的。但如果看到了横线后面的词是『一部新手机』，那么，横线上的词填『买』的概率就大得多了。<br>&emsp;&emsp;上图中的基本循环神经网络是无法对这种情况进行建模的，这时就需要另外一种双向循环神经网络模型了，如下图所示：<br><img src="/2018/10/30/浅谈深度学习/双循环神经网络.jpg" alt=""><br>&emsp;&emsp;循环神经网络在训练中很容易发生梯度爆炸和梯度消失，这导致训练时梯度不能在较长序列中一直传递下去，从而使得模型无法捕捉到长距离的影响。为了解决这些问题，后来科学家发明了一种改进型的循环神经网络：长短时记忆网络(Long Short Term Memory Network, LSTM)，它成功的解决了原始循环神经网络的缺陷，成为当前最流行的RNN，在语音识别、图片描述、自然语言处理等许多领域中成功应用。但不幸的一面是，LSTM的结构很复杂。<br>&emsp;&emsp;LSTM的思路比较简单。原始RNN的隐藏层只有一个状态，即h，它对于短期的输入非常敏感。LSTM通过增加一个状态C，来保存长期状态，来解决问题。LSTM的关键就是怎样控制长期状态c。在这里，LSTM的思路是使用三个控制开关。第一个开关，负责控制继续保存长期状态c；第二个开关，负责控制把即时状态输入到长期状态c；第三个开关，负责控制是否把长期状态c作为当前的LSTM的输出。三个开关的作用如下图所示：<br><img src="/2018/10/30/浅谈深度学习/长短时神经网络.jpg" alt=""></p>
<h3 id="递归神经网络"><a href="#递归神经网络" class="headerlink" title="递归神经网络"></a>递归神经网络</h3><p>&emsp;&emsp;循环神经网络可以用来处理包含序列结构的信息。除此之外，信息往往还存在着诸如树结构、图结构等更复杂的结构。对于这种复杂的结构，循环神经网络就无能为力了。<br>&emsp;&emsp;神经网络的输入层单元个数是固定的，因此必须用循环或者递归的方式来处理长度可变的输入。循环神经网络实现了前者，通过将长度不定的输入分割为等长度的小块，然后再依次的输入到网络中，从而实现了神经网络对变长输入的处理。一个典型的例子是，当我们处理一句话的时候，我们可以把一句话看作是词组成的序列，然后，每次向循环神经网络输入一个词，如此循环直至整句话输入完毕，循环神经网络将产生对应的输出。<br>&emsp;&emsp;然而，有时候把句子看做是词的序列是不够的，比如下面这句话：<br>&emsp;&emsp; <em>两个外语学院的学生</em><br>&emsp;&emsp;不同的语法解析树对应不同的意思。一个是『两个外语学院的/学生』，也就是学生可能有许多，但他们来自于两所外语学校；另一个是『两个/外语学院的学生』，也就是只有两个学生，他们是外语学院的。为了能够让模型区分出两个不同的意思，我们的模型必须能够按照树结构去处理信息，而不是序列，这就是递归神经网络的作用。当面对按照树/图结构处理信息更有效的任务时，递归神经网络通常都会获得不错的结果。<br>&emsp;&emsp;递归神经网络可以把一个树/图结构信息编码为一个向量，也就是把信息映射到一个语义向量空间中。这个语义向量空间满足某类性质，比如语义相似的向量距离更近。也就是说，如果两句话（尽管内容不同）它的意思是相似的，那么把它们分别编码后的两个向量的距离也相近；反之，如果两句话的意思截然不同，那么编码后向量的距离则很远。如下图所示：<br><img src="/2018/10/30/浅谈深度学习/递归神经网络.jpg" alt=""></p>
<h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h2><p>&emsp;&emsp;最后总结一下，深度学习对比以前的浅层学习只是多了一些训练策略，实际两者的背后原理是相通的。去掉了繁琐的让人望而却步的数学推导，只讲了模型结构和其优缺点，就是让大家明白各个模型到底解决什么问题，在解决问题的过程中会遇到些什么问题。个人觉得我们这些IT人员不可能去研究底层算法，那样太得不偿失了。计算机科学是一门重实践偏应用的学科，大部分人把科学家研究的模型算法针对实际场景直接用就行了，当然能懂里面的原理更好，不懂也不妨碍我们使用深度学习技术，现在深度学习出来了很多框架，例如TensorFlow，极大的降低了参与人员的门槛。希望对大家理解深度学习有帮助。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jinfei21.github.io/2018/10/28/关于挣钱的一些思考/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="费永军">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金飞的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/28/关于挣钱的一些思考/" itemprop="url">关于挣钱的一些思考</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-28T09:45:24+08:00">
                2018-10-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/杂说/" itemprop="url" rel="index">
                    <span itemprop="name">杂说</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;前段时间差点从公司离职，顶着烈日找工作，在出去碰了多次壁也拿到几个offer，虽然比我目前的待遇上略好，但还不是我满意的状态，主要是我这次太匆忙，没有想好下份工作该如何定位自己。工作这么多年从没有如此的狼狈过，公司HR还蛮好帮我转岗，经过考虑把外面的机会放弃了，暂时先留公司沉淀一段时间。<br>&emsp;&emsp;这段时间也想了不少东西，回忆起从开始工作到现在的点点滴滴。我感觉现在的状态和我学生时代没有太大差别，在上海我目前是一个人，以前在一个二本学校也是一个人。不过学生时代很充实，虽然一个人，但是很享受那种四点一线的生活，那时的目标很明确，就是考研，要换个环境，后来都实现了算是有点小成就感。从开始工作起到现在，一直没有任何成就感可言，是最迷茫的，我甚至开始羡慕起研究生同学的生活状态，有时人和人的差距比人和狗的差距更大。一直在工作，却忘记为何出发，工作中也发现一些有趣的人和事。我想大部分人应该想法和我现在一样，没有明确的职业规划，目的就是挣钱早日实现财务自由，那些想干事业改变世界的天才,普通人羡慕不来。生活就是柴米油盐，就是这些很现实的东西。上个小班拿份工资，每天面对的就是房贷和老婆孩子要养，确实中年才体会到的无奈，我想世界上没有比上班拿死工资更悲惨的事情了。这种谋身状态也就是近几百年工业社会开始慢慢成为主流的，工业社会之前几千年上万年，人们都是自我雇佣的谋生状态是主流。工业社会为了追求效率，把人异化为一颗螺丝钉，如果学习能力差的，随时可能随着经济周期被淘汰掉。<br>&emsp;&emsp;在现代功利社会，社会分层会越来越清晰，这是很多发达国家都经历的阶段，中国未来估计也难以避免。从社会分层结构来看，5%的天才加上5%的无用人群，再加上90%的普通人群。大部分在这90%的普通人中，决定他们差异的就取决于很多大量的基因以外的因素，在这些因素中钱的占比绝对高于一切，有钱的孩子选择更多，带来的机会也就更多。当很多贫苦家的孩子需要付出很多努力的时候，有钱人的孩子只要有钱就可以轻松获得，从而带来的阶层固化更为严重。有时与其说是比拼孩子的能力，不如说比拼家长的能力，通过孩子改变孩子命运的可能性非常小，真要改变孩子的命运不如改变自己的命运。<br>&emsp;&emsp;学生时代因为学校的关系，经济学的书比较多，反正那时也没有什么事情，也看了不少。现在反思发现以前看的那些东西很多都是误导，西方意识形态的经济学虽然我没有系统的学，现在说他们是伪科学可能太过于武断。不过我从常识判断，如果经济学真的有用，那经济学家应该是这个世界上最富有的人，但现实不是这样的，经济学家常常犯错误。所以最近这些年我听企业家的东西多点，经济学家的少了。如果现在一个企业家通过经济学家来指导企业经营，听经济学家胡说八道，我会觉得这个企业没有前途。<br>&emsp;&emsp;我并没有说经济学家不好，你如果想让自己变得更聪明，思维更开阔，眼界更高，吹牛忽悠更有水平，经济学家的很多东西还是非常值得去听的，但是你如果想赚钱，那我到是建议你尽量少听，第一，你如果不能穷尽一生去研究经济学，基本上都是皮毛，很多人穷尽一生，也只是皮毛。也根本指导不了你业务实践，第二，哪怕你成为大家了，你要在投资理财上发大财，其实也微乎其微，经济学家除了拿诺贝尔奖或者走穴这两种方式外，很少有赚大钱的。<br>&emsp;&emsp;你要证明一个观点是正确的，你必须要穷尽所有的事实，但是你要证明一个观点是错误的，只需要一个反例就够了。很多人想论证赚钱需要超越常人的能力，但其实现实中可以举出很多反例来反对这个观点。工作中我就遇到往往不是那些最有能力最勤奋的人在高位在拿高工资。<br>&emsp;&emsp;70后一代是幸福的一代人群，赶上中国经济腾飞的好时代。但是现在有钱的往往不是70后这拨人中当年最牛逼的，当年很多70后特别一些牛逼名校的，很多都出国读书去了，一些出不去的人只好留在国内，这些所谓的loser啥事也不干，因为要结婚生孩子，不得不买房，然后就发财了。你能说这个和能力有什么关系吗？而反观那些在国外读了n年书的就比较悲催，回国可能一套房子也买不起。有时候恰恰是你太弱了，太垃圾了，只好赚大钱。而你太强，选择太多，反而受穷。<br>&emsp;&emsp;有时会很悲催的发现，我们这些废了九牛二虎之力考上大学的，发现反而不如那些没有考上大学的同学。因为没有上大学，他们有农村户口，然后中国大面积拆迁，一个个分几百万，他妈的有的还有几十套房子。我们这些悲催的考上大学的人，都是城市户口，没有资格分地皮，然后就成了吃瓜群众。还有些初中就辍学开始闯荡江湖，更早接触社会的，要不就是做外贸领域业务，要不就是干包工头，他们赚的钱远比我们这些人多，决定这些的核心是什么？是能力吗？不是吧，运气也好，机缘也罢，肯定不是能力。<br>&emsp;&emsp;以前看过一篇文章，里面提到一个UT出来创业的小伙子，当年UT可能在全国招聘为数不多的本科生，他打败了无数人终于挤进去了，在当时绝对是巨牛逼的人，而那些被他打败的人只能黯然的走进阿里的大门，那时阿里就是容纳了一帮乌合之众，很多都是职业学校毕业的，名校几乎没有，十多年过去了，那个进了UT的天才，现在要出来创业了，那些没办法只能去阿里的人，一个个身价过亿要给那些牛逼哄哄当年逼的他们无路可走的牛人们投钱去了，能力决定一切么？好像还真不是。<br>&emsp;&emsp;这种案例其实特别多，都不是个案，都是普遍性案例，我们勤勤恳恳的做事情，在各种专业领域里，文能安邦，武能定国，发现转身一看，那些当年看上去不如我们的人赚的钱比我们多多了，宝马雕车香满路，娇妻美女娶回家。你怎么看这些问题呢？<br>&emsp;&emsp;很多人说赚大钱要让自己特别有能力，我现在不太认同这点，工作中和社会上，我见过太多能力一般的因为人生机缘，因为某种特定的机会，赚取了远远超过平均水平的利润，很多时候，很多很勤奋，很有天赋，很有才华的人，在社会最底层的时候，你一定不会认为是因为他们能力不如人，压根就不是，而那些显然不如他们的人却能赚取足够的钱，差异在哪里呢？生在城市的人机会比农村的人要多了去了，难不成农村的人一定就比城市的人要笨，要没有能力，要不勤奋？哪怕同一水平线上的人，也有很多各种机缘巧合所造成的极大差异的结果，能力向来是最不重要的点。<br>&emsp;&emsp;最近这两年我也一直在反思，因为详细了解日本房地产泡沫奔溃的惨状。所以在上海房价疯狂的那几年我没有胆量，尽管当时我努把力还能够的着，现在再怎么努力也够不着了。现在才开始明白，现实社会往往不是等价交换，如果是等价交换，就不可能一个人比另一个人富裕千倍万倍。就是因为不是等价交换，有了泡沫，才给了一些人暴富的机会。<br>&emsp;&emsp;都在说只要在风口，猪都会飞起来。这种常识没办法理解的事情，连乔布斯都说要保持饥饿保持愚蠢。而乔布斯就是那5%的天才，他要表达的意思不是我们理解的那样，看过乔布斯的传记，他是一个内心很骄傲的人。保持饥饿保持愚蠢不是我们普通人理解的那样，我们普通人已经够愚蠢了，至少在这些天才看来我们是这样，90%的人往往选择是不理智的。乔布斯这句话的意思我想是他想看愚蠢的人在想什么，然后高价满足他。这就是现实社会。所以如果投资，你就应该知道大部分普通人是如何想的，吹大泡沫，不一定要懂，只要猪能上天，你就能挣钱，压根就不用想猪如何落地，只要有人接盘就行。<br>&emsp;&emsp;李笑来就是个很好的例子。别看他写书一套一套的，他挣钱也就靠比特币这波收割了不少韭菜，我当时没办法理解区块链和比特币居然都能挣钱。现在我看依然是毫无价值的东西。任何一个负责任的政府都会控制货币，不可能使用一个不受自己控制的货币在社会上流通。虽然政府控制货币发行常常导致通货膨胀，如果电子货币流通，就一定能避免通货膨胀保证公平了吗？我想受益的一定是那些懂技术的天才，大部分普通人只能当吃瓜群众。话虽如此，可依然有很多人追捧。有个很著名的投资人是这样解释的：因为世界上无知者占了主要的部分，90%的人是不懂的，不懂就算了，他们还手里钱特别多，很容易就被忽悠把钱投给那些实际上结果必死的垃圾身上，于是硬生生的就出来一个很悖论的结论，越是不好的东西，越容易被追捧，从而出现极大的泡沫。<br>&emsp;&emsp;这个世界真正赚钱的机会一定是来自泡沫的钱，泡沫才是暴利的基础，没有泡沫就不会有超额利润的存在，房子如果不大面积涨价，怎么可能会有财富的大幅度上涨呢？股票如果没有泡沫存在，凭什么让很多人人身价一上市瞬间成首富呢？同一个公司，基本面没有任何变化，为什么会价格差很多倍呢？只有泡沫来的时候，才有可能让一个公司或者一个事物的价格远远偏离价值，才有让你发大财的机会。这种案例不要多说了，都是如此，只要资金汹涌而来的时候，才会有这种情况出现，不是你变得值钱了，而是市场让你看上去更值钱了，你本身没有任何变化。你的价值没有变化，变化的只是价格，价值跟你商业模式，利润增长相关，但是价格表现的所谓估值，事实上跟价值没有任何关系，跟人们是否喜欢你，跟资金是否充沛，跟民众的智商高低相关，你会发现越是民众智商低的社会，越是资金泛滥的时候，泡沫一定是越高的，泡沫席卷到某个领域的时候，你刚好有这个事物，OK，你就发大财了，所以，你要做的事情是要享受泡沫的过程，然后在估值回归合理的时候，跑出去。没有价格高估的话，他只能代表合理价值也就是平均社会利润，那能赚什么大钱呢？不可能的事情。<br>&emsp;&emsp;那什么时候价格高估呢？前面说了，民众智商越低，且手头上有钱的时候啊，每当这个时候，一定是一大堆不知到价值是什么东西的大叔大妈进来买买买的时候，才可能出现价格严重高估的时候，一堆人非理性的疯狂情绪出现了，市场价格就被推起来了，你就可以发大财了，否则你永远是社会稳定收益者，这个也是为什么有些无知者反而比聪明人赚钱很多的原因，你越懂一个事物的真正价值，你就越不敢去触碰他们，因为你知道他们不值钱，你去碰它，你心里承受能力是有限的，你会睡不着觉，最终你肯定就不敢碰了。但是无知者不懂一个事物到底有没有价值，他根本不会去自己研究一个东西，会人云亦云，会因为莫名其妙的事情去认为一个事物好不好，没有任何逻辑可言，所以他敢坚定的持有一个其实没有任何价值的东西，最终的结果是什么呢？结果很有意思，绝大部分冲进来无知者最后一定是被证明是愚蠢的，他们做了接盘侠，但是一定有一部分无知者却赚了大钱。当然聪明的人因为不参与这种过程，结果是比大部分无知者好点，但是比那些赚钱的无知者要差很多很多。<br>&emsp;&emsp;从这个角度想，凡是不参与泡沫的人，最后的结果一定是社会稳定利润，是很难有超额收益的，最赚钱的人一定是泡沫来之前进去，泡沫灭之前跑开，但是这个技术难度是很大的，绝大部分都是蒙着的，地震来了都有人能跑开，谁敢说自己是靠能力跑开的，往往运气起到了决定性作用，许多赚大钱的人明明是赚了运气成分的钱，但是他会用一百个理由告诉你是自己能干赚的。分析的头头是道，本质都是哗众取宠。所以泡沫来了有两种人，一种人整天说泡沫来了，要崩盘了。一种人却跳进泡沫里游泳，前者越来越聪明，后者越来越有钱。<br>&emsp;&emsp;这个世界最简单的事情，就是说泡沫一定会灭，这个是正确的废话，就如同人一定会死，宇宙一定会灭亡一样的言论，前面说了，因为结果是注定的，过程是不一样的，泡沫会灭，但是什么时候灭，结果是不一样的。中国过去十几年本质上都是一个泡沫堆积的过程，如果不参与到这个过程中，很多人都注定无法获得财富，只是因为房产是每个人生活的必需品，所以导致的结果是过去十几年几乎人人无形之中都参与到了泡沫化的过程，真正出现改变是多年前的股权投资的泡沫化，这轮泡沫化进程只有少部分人参与到了，被资本市场和喜欢的人享受到了虚拟经济的泡沫化的红利，绝大部分企业家是没有享受到的，于是出现的是冰火二重天的格局，凡是站在虚拟经济这边的人过去五年财富增长十几倍，而站在实体经济这边的人，相对来说日子就惨淡很多。<br>&emsp;&emsp;泡沫本质就是不懂的人聚在一起才会创造出来的情况，所以你了解不懂的人在想什么绝对比你懂什么更为重要了。只有知道社会群体性的追逐一样事物的时候，才有这个事物泡沫化的可能性。提前站进去，等他们进来你再出去，是赚大钱的核心中的核心。这些背后不是专业性，也不需要专业性去支撑，只要你多去了解别人怎么想，多点同理心就行了。再多勤快点，别固步自封不愿意看别人在干什么，整天只想到自己，觉得自己最牛逼，这种情况基本上就是等死了。<br>&emsp;&emsp;从人性角度来看问题的话，大多数人的心理其实就是这么微妙的，总感觉很多事情必然有因果，只是世界上很多事情是没有必然关系的，譬如不会因为你努力了就一定会成功，也譬如不会你努力分析了就一定能得出正确的结论，世界上很多事情是没有任何因果逻辑关系，都是随机偶然不可测的事情。但是很多人不这么想，人性深处都是这种错觉，认为了解不比了解好，掌控比不掌控好，总感觉知道一些比什么都不知道要好。事实上，你知道和不知道，了解和不了解，掌控和不掌控，事情的结果并不会发生太大的变化。甚至很多时候恰恰相反，因为掌控，而导致别人不愿意跟你玩，因为你懂，反而你望而却步，不敢下手，错失机会，这种事情多了去了。除非真正精通某一个行业，同时对这个行业周边以及投资等很多事物都非常充分的了解，否则你懂9成跟你什么都不懂事实上是没有区别的，甚至可能更糟糕。半桶子水晃荡的下场是最不好的，似是而非，往往误入歧途。还不如什么都不懂的结果更好。<br>&emsp;&emsp;好吧，关于挣钱的一些思考就写到这，我也不知道里面有没有负能量。虽然目前我认为挣钱和努力没有任何关系，也和能力无关，但是我一直觉得努力应该是习惯而不是功利手段。只有富有挑战，才让自己更有价值。其中的观点很好的解释了我视野范围内的一些事情，不管怎么说这些思考会让我以后以更好的心态生活和工作。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jinfei21.github.io/2018/10/20/聊聊无印良品的品牌之路/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="费永军">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金飞的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/20/聊聊无印良品的品牌之路/" itemprop="url">聊聊无印良品的品牌之路</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-20T14:51:41+08:00">
                2018-10-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/杂说/" itemprop="url" rel="index">
                    <span itemprop="name">杂说</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;这期本来是要聊挣钱和能力的关系，由于昨天和领导私人会谈亮明了我鲜明的态度，在我看来我是表明立场，在他看来是偏激。我立马说偏激是中性词，请和极端分开。由这个话题呢，我想起前段时间了解的无印良品的品牌逆袭之路，我个人觉得就是偏激策略的成功。中国文化骨子里中庸之道，会导致绝大多数人本能的排斥偏激。我觉得也正因如此才导致国内知名品牌太少了，而中国是一个感性民族，理应产生更多品牌。<br>&emsp;&emsp;无印良品是创立于80年代的日本经济繁荣期，源于一家类似家乐福的超市运营公司西友百货。西友想打造自己的原创品牌，于是有了无印良品这个部门。这就解释了，为什么无印良品什么都做，又是服装，又是食品，又是家居。一般来说，做得这么杂的品牌公司很少见，品类太多，导致给用户传达公司品牌印象会变得非常有挑战和难度。无印良品从最初40种产品扩充到现在的7000种产品，所要面对的难题不是如何生产这些产品，而是如何在品牌产品种类的扩展过程中始终坚持品牌的初衷。<br>&emsp;&emsp;那么无印良品的品牌初衷是什么呢？80年代的日本，消费者面临两级分化的消费习惯，要么是海外奢侈品，非常酷非常高级个性化，但是通常价格都很贵，一般用户消费不起。要么是价格便宜质量粗糙的低端产品市场，这就有点类似国内目前的状况，阿里和京东清理假货和山寨货给了拼多多机会。既然无良印品要走品牌之路，必须要给品牌赋予价值观。无良印品这时候提供给用户第三种选择，既不是山寨别人，是清晰的传达给用户，价格便宜质量够好，注意是指质量够好不是非常好，无印良品想告诉用户回归平常心，不要为了逼格而付出过高的成本，不要迷失在攀比的欲望里不能自拔。所以无印良品和高端路线的产品正好相反，极力去除产品的个性，让它看上去并不酷。</p>
<p>&emsp;&emsp;无印良品的这种策略其实有三个方向的考虑：</p>
<ul>
<li>1、盲目追求高端、个性化，意味着产品要不断升级、不断换花样，这样会给企业带来过高的研发成本和营销成本，实际上带给用户的价值有限，就像目前苹果遇到的困境一样。而无印良品希望摆脱这种造流行的循环，提供一种无个性通用类的设计，就可以一直生产下去，以不变应万变。</li>
<li>2、成本可控，减少不必要的工序，同时降低成品的成本。</li>
<li>3、日本人的传统审美观念，是追求简洁素雅，和式风格深入日本人心。这种策略有一定的民意基础。</li>
</ul>
<p>&emsp;&emsp;无良印品在保证质量够好的前提下，通过精选素材、检查工序、精简包装这三板斧降低成本。</p>
<blockquote>
<p>精选素材：不是选择最好的材料，而是选择够好的材料，加大可利用率。例如无印良品的三文鱼罐头和碎香菇就是这种思路，保持原始材料的天然属性，不加工，比如不使用漂白剂、染色剂。</p>
</blockquote>
<blockquote>
<p>检查工序：保证产品可用性基础之上，去掉所有为了装饰而增加的工序，保证工序最简。如果可能的话，挑战传统设计，进一步减少工序和用料。</p>
</blockquote>
<blockquote>
<p>精简包装：包装不做任何修饰，尽量降低包装成本。</p>
</blockquote>
<p>&emsp;&emsp;我们村有人是开服装厂的，有一次我问他他们家生产的羽绒服多少钱一件，他说几十块钱，而我买的明明就是几百块钱，当时我还很吃惊。后面了解营销策略后算是理解了。比如你有100块钱，要完成打广告、产品包装和产品本身这三件事，这100块你如何分配？答案是，花90块打广告，花9块钱包装产品、花1块钱做产品本身。听起来很荒谬，但却是最好收益比的策略，这或许就是操纵人性的高明之道吧。你可以说它不合理，但是商家不会告诉你真相，你看了90块广告后，就会错误的认为手上1块钱的东西真值100块。<br>&emsp;&emsp;最初无良印品没有品牌知名度的积累，又面对高端和低端市场的双面夹击，它该如何突围呢？其实它是选择的低端市场，它固执的打广告，将自己又便宜质量又好的定位清晰的传达给用户，便宜不是本事，又便宜又好才是本事，才是自己在低端市场的核心竞争所在。它不仅清晰的传达自己的定位，还告诉用户具体原因，为什么我可以做的又好又便宜？不同于外面那些便宜姚艳货，我们的产品便宜是有原因的。<br>&emsp;&emsp;具体来说，无印良品在两个地方向用户传递着“无印良品便宜是有原因的”，一是报纸广告，二是产品包装袋。报纸广告是引流的，产品包装是进一步强化这个印象，也因此产生了病毒式的传播效应，和拼多多的拼团有点类似了。<br>&emsp;&emsp;我想，用户在做任何一个选择时，一定是脑子里先有一个故事，比如说这家的产品很有逼格、这家的产品质量特别好、这家的产品超级便宜等等，这便是定位，是品牌印象。无印良品很聪明的一点是，它在一开始就选择好了一个切入点，设计好了一个品牌印象，并讲了一个说得通又让人记得住的故事，让人记住了这个品牌。这并不是什么设计问题，这是一个营销问题。无印良品后面讲了环保概念、日本传统文化、去欲望回归平和心态等等故事，在我看来全是编故事，“便宜是有原因的”才是最初无印良品可以立足的真正原因。<br>&emsp;&emsp;但是随后在1999年到2001年期间，无良印品的销量情况急转直下，出现了有史以来的第一次亏损。最初的品牌理念遇到的极大的挑战，严重动摇的创作团队和忠实客户的信心。在经济全球化时代，无印良品没有顺应“代工厂移到用人成本低的不发达国家”这个潮流，而且随着工业时代的推进，不染色的原材料甚至比染色的原材料更贵，导致无印良品的“低价”优势不复存在造成的。“又便宜又好”这个故事，已经不再成立了。<br>&emsp;&emsp;这时候无良印品不得不放弃走低端路线，只有走高端路线这种附加值高的路线，公司才能持续活下去。那么无良印品如何从一个偏激度走到另一偏激度的呢？既要卖的贵，还要不专注品类什么都做，还要不花心思在包装上，同时让用户花大价钱买个看似平淡无奇的东西。这时无良印品讲起了环保、消除欲望、简约而不简单、日本文化之美。不得不说，这次即时的调整改进了公司定位，给了公司后续持续发展的动力。今时今日，无印良品已经华丽地由“又便宜又好的”低端市场，杀向了“大谈价值观，高价得有理”的高端市场，完成了转型，虽然从产品设计上还是遵循他一贯的理念，但是传递的价值观已经变了，在这个过程中，营销定位功不可没。<br>&emsp;&emsp;无良印品改走高端策略，它支撑自己高价策略的资本是什么？它其实和LV、耐克的高端路线不一样，它不能放弃原生态无装饰的特色，但这又和高价冲突。既然你平平无奇，消费者为什么要为你买单？所以一方面无印良品高打价值观输出这张牌，另一方面也在试探价格定在什么价位可以达到用户愿意买单的门槛？<br>&emsp;&emsp;前面讲到过，无印良品的一大特点就是不做出格的设计，只做看似普通的简洁的产品。在日本本土，因为传统的审美观念里就有以朴素为美的基因，所以日本本土的接受度还可以，但如果要做全球化，其他国家的人能接受这种审美吗？特别是价格还卖那么贵？无印良品是如何处理的呢？积极参加一些设计展，推广日本文化，筹备自己的酒店，尽可能将自己的产品理念向外界宣传。<br>&emsp;&emsp;这一点确实佩服日本人，日本人很好地解释了“越是民族的，越是世界的”这句话。不追求外界的流行，坚守自己的传统的文化，最大化地宣扬和输出自己的传统文化。我不跟从你，我突出自己的个性，让你来接受我的差异化理念。<br>&emsp;&emsp;关于无良印品逆袭之路就聊到这。可能中国人的中庸之道，导致国人骨子里总是想柔和各方，这种处世之道在处理某些事情可能有优势，某些情况反而是劣势，我个人认为品牌就是偏激策略的成功。你不可能迎合所有人，你需要有选择懂得放弃，降低你迎合的难度，找准自己的定位发现自己真正的用户，然后采取针对性的策略。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jinfei21.github.io/2018/10/13/血酬史观/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="费永军">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金飞的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/13/血酬史观/" itemprop="url">血酬史观</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-13T18:06:43+08:00">
                2018-10-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/历史/" itemprop="url" rel="index">
                    <span itemprop="name">历史</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;在我们以往的历史观中，人类经历了原始社会、奴隶社会、封建社会、资本主义社会、以及社会主义这几个阶段，这都是教科书教给我们的东西。生产力和生产关系的矛盾推动社会从原始社会到奴隶社会，再到封建社会的变迁，这原本是西方马克思唯物历史观的一套历史分析框架。中国人生搬硬套用这套理论来解释中国历史往往会和我们的常识不符合，因为中国没有经历奴隶社会也没有经历资本主义社会。直到大学期间看到吴思的潜规则和血酬史观的相关东西，用这些理论来解释中国历史和社会变迁更符合历史史实，今天就聊聊这一话题。<br>&emsp;&emsp;社会上我们经常听到一种黑话，叫这个人血旺给他放点血，或者我今天出血了。血本身包含着强迫暴力的意思在里面，血酬史观讲的就是通过暴力获得收益来解释历史的一种分析框架，包含着暴力集团和生产集团相互妥协推动着社会制度演化（请注意我用的是演化不是进步），这和生产力与生产关系的理论完全不是一回事。暴力掠夺不创造财富，但暴力跟生产发生了一种关系，这个关系是什么样的关系呢？美国经济学家拉夫尔给总统讲税收的原理，税率和税收总额的关系，被称为拉弗曲线。这条曲线就描绘了暴力集团和生产集团的关系。当暴力集团无限制抢劫生产集团时，超过拉弗曲线的临界值就会导致生产集团和暴力集团的激烈冲突，甚至严重到改朝换代。</p>
<blockquote>
<p>拉弗曲线描绘了政府的税收收入与税率之间的关系，当税率在一定的限度以下时，提高税率能增加政府税收收入，但超过这一限度时，再提高税率反而导致政府税收收入减少。</p>
</blockquote>
<p>&emsp;&emsp;交代了前面的一些背景，下面从两个历史故事开始：<br>&emsp;&emsp;清朝有个黑彝人叫刘宇青，他在1877年写了一封信，告诉自己的子孙万代将来怎么搞好生产。<br>&emsp;&emsp;彝族社会有三个阶层，最高层的贵族叫黑彝，他们说自己的骨头是黑的，打起仗里英勇无畏。第二层是贫民百姓，跟我们一样，是凡人，骨头是白骨，叫白彝，他们要给黑彝贵族纳税。黑彝带着白彝去打仗，到汉族抢来奴隶叫娃子，就是第三层，外面耕地的一般叫做娃子。<br>&emsp;&emsp;刘宇青说，他的祖先在明万历年间有好几百个娃子，但是这帮奴隶偷懒不干活，下地干活出力不勤，打猎不中，还总偷吃偷喝。最后到年底，发现他们种地、狩猎收获的东西还不够他们自己吃的。<br>&emsp;&emsp;奴隶制闹到这个份上就成了赔本的买卖。所以刘宇青的祖先开始改革。他们把所有的土地分作两半，一半自己留着，另外一半分给所有的娃子，鼓励他们安家立业。原来是集体宿舍，现在全村到处都可以住，最好都成家，一家给一点地，没有农具再分点农具，但是每次种自己的地之前要先把贵族的地种了，收割庄稼之前先把贵族的庄稼给收了，得先公后私。这就有点类似西周历史上的“井田制”。<br>&emsp;&emsp;这个制度带来了巨大的收益，现在一半土地的收益能顶上过去全部土地的收益。这就是过去制度的优越性和大包干的优越性。但是很快这个收益开始下降。<br>&emsp;&emsp;又过了一百年，当年享受政策恩惠的那批人都过世了，他们的子孙觉得天生就应该这样，于是在主人家地里干活偷懒，好好种自己的自留地，不好好种公家的土地。<br>&emsp;&emsp;所以就又改革，把所有的公田全分了，以后收50%的地租。把集体的地分田单干，弱者取得了明显的收益，地主省心了，不用去催他们干活了，收益就来了。<br>&emsp;&emsp;在1913年，四川省广汉县，其境内有一条川陕大道。有五拨土匪经常在这条道上抢来抢去，所以很快就没人走这条路了。没有人可以抢，土匪就没饭吃，这样不行。所以他们就聚在一起商量，达成了一个协议：把这条路分成五段，比如一共100里，那就每帮土匪20里。大家可以收费，但是不能把人给抢完了。所以，土匪们就建立了一个个“收费站”，还定了个收费标准：空手客五毛钱，包袱客、小商小贩一块钱。当时一个现大洋，大约相当于现在30多块人民币的购买力。并且土匪们承诺，保证过路客在他们“管理”的那段路上的安全，绝不会再有第二次收费，也绝不会有别的土匪来抢。<br>&emsp;&emsp;这个承诺大家都遵守吗？大家都遵守的，因为他们要是不遵守，下一拨土匪就绝对不会客气：你们都抢完了，到我这儿就没了。就这样，收费标准有了，规矩有了，渐渐地行人也有了，土匪们也有了固定的收入，于是川陕大道上建立起了一种秩序。这种秩序被称为“匪秩序”。匪秩序让土匪们尝到了甜头，所以很快这个规矩就向广汉全境扩展，然后就变成到处都是土匪，到处都是抢劫的，就没人种田了，所以农业一片凋敝。没有人种田，大家就没吃的了，肯定不行。怎么办呢？土匪们开始“招商引资”，让大家都回来种地，保证不抢，但是得收点保护费，比如一亩地一斗米。当时四川盆地的粮食亩产大概是200斤，也就是两担，一斗是5%，相当于税率是5%。而且土匪们还承诺：别的土匪来了，我们替你打走；有人重复收费，我们也严肃处理。当时真的就有小土匪敲诈勒索，土匪头子就找到这个人，直接就枪毙了。就这样，广汉境内又建立起了一个新的秩序，然后渐渐有了人烟，有了生产，土匪也过上了好生活。<br>&emsp;&emsp;从这两个故事，我们能引出什么？<br>&emsp;&emsp;第一个问题是：暴力集团（土匪或者贵族）叫什么？暴力集团的收入叫什么？<br>&emsp;&emsp;暴力集团的收入是通过暴力掠夺的收入，叫血酬。但是后来人家立了规矩了，也守规矩了，那还是血酬吗？吴思老师把它称为法酬。法酬是血酬的升级版。<br>&emsp;&emsp;1913年的时候，天下未乱蜀先乱，四川军阀混战。一个军阀占了一块地盘后就开始征税。如果上个军阀已经把今年的、明年的都征了，怎么办？就再往下征。所以1917年的时候，军阀的税已经征到了2011年。请问这到底是土匪还是官府？你看土匪只收5%的税率。所以，那时候土匪和政府的边界变得越来越模糊。他们吃的都是法酬，拿的都是暴力掠夺的收入。但是吃多久、吃多狠，这就决定了他们是匪还是官。他们的身份应该是由此来决定的，而不能光看他们的头衔。<br>&emsp;&emsp;第二个问题是，暴力集团都是按什么规矩来办事的？<br>&emsp;&emsp;暴力集团他们都要争取利益的最大化。如果他们得到的太多，就会导致奴隶不干活，农民和行人就绕道了，暴力集团就获得不了收益。从这些行为中，吴思老师发现了一个定律，称之为“生存策略选择定律”，就是当某种生存策略给你带来的收益大于成本时，你就会选择一条收益更高，甚至可能是卖命的路上去。这样身份就发生了转换。此外，吴思老师还在拉弗曲线的基础上，提出了最佳抢劫率的概念，由暴力集团内外关系的演变分析政治制度的变迁。<br>&emsp;&emsp;血酬史观下的中国制度变迁,如果用血酬史观来解释中国历史的变迁，则那些在传统历史观中的争论会得到很好的解答。<br>&emsp;&emsp;暴力产生了部落,部落出现之前，原始人类的基本生活状态是以家庭（家族）为核心的采集和狩猎。为什么会出现部落？用采集狩猎的需要、用生产力和生产关系解释不了部落的产生。那些从事采集和狩猎的人每天从事几个小时的劳动就足以果腹，大猩猩吃饱了就晒太阳抓虱子了，不会形成更大的部落。部落不是生产发展的需要，不是畜牧和狩猎的需要，而是暴力竞争的产物。中国文明史的开端，就是炎帝部落和黄帝部落的战争和联盟，部落之间的对抗就是用暴力争抢地盘。<br>&emsp;&emsp;暴力制造了奴隶制,部落之间的战争和联盟形成了更大和更强的部落，暴力组织的控制能力超过了一个普通人的逃亡能力，那些被抓住的战俘或者掳掠来的劳动力就被强迫劳动，成为奴隶。奴隶制来源于暴力对抗和暴力组织的发展，来源于榨取剩余能力的提高，而不是提供剩余能力的提高。奴隶制不是生产力发展的结果，而是暴力发达的结果，是暴力组织发育的结果。<br>&emsp;&emsp;封建制度也不是生产力发展的结果，农耕时代的生产力在过去2000多年来没什么大的变化。封建制度是利用亲属组织的一种暴力分配和组织机制。它根据暴力服务的能力来分配土地、生产资料和其他资源。封建制解决了一个自卫的问题，但却导致战争不断，周朝到春秋战国时期一直是战祸延绵。因为在封建制度下，打仗是有利可图的。历史记载，每逢发动战争，秦国人就在咸阳欢呼雀跃，因为他们可以有机会通过战争获得土地和财产。在战争结果的分配中，暴力集团首领获得的比例最高，更激发了诸侯发动战争的动力。<br>&emsp;&emsp;作为一种理论框架,“血酬史观”是从暴力的角度对历史演进做出一种解释，它和唯物史观并不冲突。一旦生产集团的首领资本家主控制了军队和国家机器，暴力集团就变成了资本家的保安和守夜人，这个社会就变成了资本主义。在资本主义社会，历史唯物主义就开始有效了，生产力能够决定生产关系，经济基础开始决定上层建筑。但唯物史观的局限性也很快凸显。资本家的剥削导致了工人运动的产生，工人可以投票，工会也可以控制选票了，也能当家作主，那就不是资本家一个人当家作主，历史进入民主时代，这个时候自由史观就开始超出唯物史观。<br>&emsp;&emsp;血酬史观就聊到这。从初中开始学习历史，我个人感觉历史教科书就是一本历史杂志，让人记住一堆历史事件历史人物，到现在很多东西都忘记了。没有教一个贯穿其中的历史逻辑，就是简单的往历史唯物主义里面套，然后还用这套东西考试，我是觉得我们所受的历史教育是很失败的。学不到任何以史为鉴的智慧，其实历史可以很有趣，就像当年明月写的明朝那些事儿，历史不仅有王侯将相，更有家长里短，还有作者个人的评价，你能学到很多历史人物身上表现出来的人生智慧。不过还好，历史不像数学有年龄限制，随着年纪增大，同样的历史事件个人的解读会更丰富更深刻。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jinfei21.github.io/2018/10/08/技术人35岁的隐忧/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="费永军">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金飞的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/08/技术人35岁的隐忧/" itemprop="url">技术人35岁的隐忧</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-08T20:43:53+08:00">
                2018-10-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/杂说/" itemprop="url" rel="index">
                    <span itemprop="name">杂说</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;每周一篇博客，因为国庆回武汉看望老婆小孩，所以耽误了。原定是要发一篇有关历史的博文，只能这周末再发了。这次回家待了7天，今天第一天上班，效率不是很高，早早下班就回家了，因为有心事，正如标题所言我如今也到了这个坎。<br>&emsp;&emsp;本科毕业十年了，上海我始终没有安下家，没能给老婆小孩一个好的物质条件，只能退居二线到老家的省会城市安家。我也是沪漂近十年了，直到去年还是和老婆一起在上海打拼，如今只剩我孤身一人，小孩和老婆成了留守妇女和儿童了。我也不知道我在上海到底在坚守什么？人最怕就是迷失自我。<br>&emsp;&emsp;虽然现在对比7年前，我不用租房子了，住在自己的远破小房子里，再也不用担心房东找茬了，但是和我研究生同学对比，他们都住上千万的房子，和老婆小孩在一起，工作和家庭都能兼顾，而我就是处在底层的平民窟，每次想到这我就不能放弃自己，得逼着自己拼到40岁，实在不行就回武汉。这就是一场赌博，我赔上的是我与家人相聚和参与小孩成长的时光。我希望她们能来上海生活，虽然目前上海还安不下我的灵魂和肉身，但是我骨子里还是喜欢上海的氛围，毕竟我在上海已经生活了十年多了，很多东西都习惯了。<br>&emsp;&emsp;因为每天上班坐地铁一个多小时里看了不少公众号，一个技术人的中年危机时常会让我焦虑。以前我倒没觉得技术人年龄还是一个问题，今年差点从公司离职我是深深体会到了。年龄大了会少了很多年少时的轻狂，意味着失去了更多尝试的勇气，却多了很多世俗的牵绊，很多时候会越来越身不由己，慢慢会让自己变的封闭。<br>&emsp;&emsp;毕业前几年我每天都很充实，现在很久都没有这种感觉了。有太多事情做，时间也不够用，却不知道从何入手，失去目标更是远离了梦想，现在感觉越来越失去自我了，要做回自己太难。我也到了羡慕年轻的年纪了，年轻随时可以说走就走说不干就不干，而中年人不行，有时候你不得不咬紧牙关硬挺。自从老婆回武汉以后，我书读的越来越少了，内心的进步越来越不明显，反而岁月的印记在脸上不断加深。去年一年多整个人都不太好，工作中常常在妥协中徘徊廷难受的，人性的不完美在我心中不断放大，充斥了很多负能量，也颠覆了我很多已有的观念。<br>&emsp;&emsp;过去我一直天真的以为只要努力就会得到认可，就会得到想要的结果，过去一年多的现实彻底击穿了我的心灵。曾经选择来公司，是因为激情，是希望和一帮优秀的人真正做成一件我没有尝试过的事。我对新鲜的事物一直抱有极大的好奇心，总是充满激情地大胆尝试，却在挫折面前撞得头破血流，所有的理想都变成了幻想，一切都变得有些陌生了，难道一开始就错了吗？<br>&emsp;&emsp;转岗有一段时间了，我还有半年的过渡期。夜深人静的时候，我才能感到释放和宁静，不再有胡思乱想的焦虑，剩下的就是所谓的“深思熟虑”。曾今的梦想都变成了遥不可及的记忆，都不敢轻易触碰，只能小心翼翼的闪过。<br>&emsp;&emsp;现实总是让人们又爱又恨，我们需要一个无比强大的内心来适应这个现实，现实可以让我们一次次跌倒，我们只需要+1次爬起来继续努力。生容易，活容易，生活不容易，和与我一样在上海努力奋斗的沪漂们共勉吧！</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jinfei21.github.io/2018/09/29/基于规则的风控系统/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="费永军">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金飞的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/29/基于规则的风控系统/" itemprop="url">基于规则的风控系统</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-29T15:25:28+08:00">
                2018-09-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;转岗到平研创新Team一直在忙于风险系统的优化升级。上一次聊到对系统问题如何解决的方法论，这次碰到的就是这类问题，因为不是简单的线性问题，所以不能通过优化一个单点解决问题。今天就聊聊这一个多月忙的事情。<br>&emsp;&emsp;当前互联网企业存在很多风险，特别是金融行业，一直被羊毛党，刷单党光顾。比如像一些账号问题，由于用户的使用习惯，会在各个站点注册账号使用相同的用户名和密码，这就给了黑产份子可乘之机。他们会找相对比较小安全防护不严的网站利用SQL注入或者其他漏洞进行拖库，获取用户的账号信息，然后对密码进行清洗，俗称洗库，最后拿到用户登录账号明文信息到一些知名网站去试，俗称撞库，这有可能对用户造成损失。<br>&emsp;&emsp;由于以上一些问题的存在，要面对互联网上的实时攻击。风控系统需要解决如下问题：</p>
<ul>
<li>哪些业务是有风险的，注册、登录、交易、活动等等，这需要业务方埋点传入合适的参数。</li>
<li>什么事件是有风险的，这需要用到统计学，对异常用户的历史数据做统计分析，找出异于正常用户的特征。</li>
<li>实时性，而且对风险事件必须是毫秒级的响应，有些场景需要尽快拦截，及时给用户挽回损失。</li>
<li>低误报，需要人工风控经验，对各种场景的风险阈值和评分设置，需要长期不断的调整。</li>
<li>支持对历史数据的回溯，能够发现以前的未发现的风险，对现有的策略设定提供参考。</li>
</ul>
<p>&emsp;&emsp;公司现有的风控系统架构如下所示：<br><img src="/2018/09/29/基于规则的风控系统/风控系统架构.png" alt=""><br>&emsp;&emsp;整个系统是一个单体结构，外部系统直接通过接口调用得到实时的风险等级标识，然后业务系统根据风险等级标识采取相应的措施，比如验证码或者拒绝阻塞。接口需要传入策略名称，策略是规则引擎定义的模型对应一组规则，每个规则都对应一组指标。风控系统的核心就是规则引擎，一个好的规则引擎可以方便业务方随时变更验证逻辑而不用重启服务。既要保证服务的稳定又要不失灵活性。规则引擎我们是采用执行groovy脚本，可以灵活变更规则逻辑。这需要对领域模型进行抽象，目前抽象出了策略、规则和指标关系如下图所示：<br><img src="/2018/09/29/基于规则的风控系统/规则引擎.png" alt=""><br>&emsp;&emsp;可以把策略理解成规则集合，策略是最终判别风险的依据。系统根据所有规则的分值汇总得到总和，总和越大说明风险等级越高。规则就是需要执行的脚本逻辑，会查询指标然后和阈值比对，如果大于阈值就返回相应的分值。对业务方而言只需要关心策略配置和阈值等级设定，脚本逻辑不需要关心。脚本逻辑是应对各种场景的关键，里面有一些逻辑处理，需要查询存储数据库查找对应指标值和历史数据。<br>&emsp;&emsp;业务方在接入时首先传入策略名称，这是风控系统定位规则集合的唯一标识，拿到规则集合后会执行相应的规则脚本汇总分值，再根据业务方在后台系统配置的等级规则判别相应的等级，最后返回给业务方，业务方拿到风险等级后再去做一些风险处理。整个过程不是很复杂，但是因为是单体结构，很多代码逻辑耦合在一起，难于维护而且也不好改进。因为一旦涉及到改动就会影响原有逻辑，总结一下目前系统架构有如下不足：</p>
<ul>
<li>只有统计规则和静态规则，像一些行为规则和关联规则支持不了。</li>
<li>规则阈值和风险等级的设定没有客观评价指标。</li>
<li>系统功能耦合在一起，数据采集、限流和指标计算都在一个接口中。</li>
<li>没有充分利用缓存，仅仅把缓存当配置中心使用。</li>
<li>接入场景单一，只支持同步接入同步处理风险。</li>
</ul>
<p>&emsp;&emsp;以上是目前系统痛点，更关键的是如果单纯的从系统层面优化没有多大意义。因为对业务方来说是想要需要知道策略的实际效果，进行风险识别时是否影响到了用户体验，是否预防到了真正风险，这些都没有一个离线分析的指标做参考。所以下图所示的一个反馈闭环很重要：<br><img src="/2018/09/29/基于规则的风控系统/闭环.png" alt=""><br>&emsp;&emsp;一般来说业务方在接入风控系统时需要先配置策略规则，然后设定每个规则对应的阈值和分值等级，完了就可以应用上线观测实际预测的效果，实际的预测结果只能依赖离线分析，可能需要对用户历史操作轨迹进行分析，如果预测结果拦截的都是正常操作的用户，这时可能就需要调整阈值。有了这个闭环就知道接下来需要做的事情了，后面所有的架构都是围绕这个闭环来进行。经过重新梳理后架构图如下：<br><img src="/2018/09/29/基于规则的风控系统/新架构.png" alt=""><br>&emsp;&emsp;新架构对原有逻辑功能进行了拆分。接入层主要是进行数据格式检查和信息丰富，比如ip地址可能需要转化为地区城市，浏览器类型需要打标识，然后将数据落地写入kafka，以便接下来的离线分析和回溯。核心层就是规则同步和策略匹配，这块是比较核心的东西，会随着业务变化架构层面不直接对接业务，所以下沉在接入层后面，接入层对外是不可变的。数据落地后有实时Job进行一些指标分析入库，这样用户在设定指标阈值时可以根据历史数据参考，比如同一个ip最近7天登录次数，这个次数阈值可以基于历史用户来设定，这样业务方在设定阈值时也有一个预期大概会拦截多少用户，多少用户会受影响。接入方式可以有同步和异步，同步需要实时响应用户告诉用户风险等级。异步就是用户发来数据就完事了，后台的实时job会读取kafka的数据利用CEP模型的esper框架进行风险预测然后采取相应的动作。<br>&emsp;&emsp;在功能层面也会更丰富一些，老的架构是直接写入druid，指标分析是实时去查druid的数据做汇总统计。这样做的好处就是实现简单，但性能随着调用量增多会下降，如果能事先把一些指标计算好，使用时直接来查不用做实时计算性能会提升很大。同时加强了后台管理的能力，用户和管理员各自关注不同领域。<br><img src="/2018/09/29/基于规则的风控系统/规则库.png" alt=""><br>&emsp;&emsp;开发者也就是管理员会根据业务需求编写规则脚本，然后业务方再配置这些规则脚本的阈值和分值。规则方面可以支持四种：</p>
<ul>
<li>静态规则<br>基于某个静态值的限制性规则，比如三元验证一致、是否命中黑名单、常用联系人验证、电信服务使用地理范围验证等</li>
<li>统计规则<br>用统计计算的值来作为验证的条件，如来自某个设备或者IP的申请次数大于某个值</li>
<li>关联规则<br>指用户在进行了某个操作之后，又执行另外一个操作，带来的风险。例如，修改账号密码后，进行交易操作</li>
<li>行为规则<br>指用户的异常行为，例如用户在常驻地址或者某个特殊的时间如深夜，进行了交易操作，一般也认为具备一定的风险</li>
</ul>
<p>&emsp;&emsp;风控系统实际是包含两部分内容，一是识别风险，二是对识别后的风险或是自动的或是人工的进行处理。后台系统增加了惩罚管理，相对于原先风险处理硬编码在业务逻辑中，惩罚管理可以做到配置化的分级处理，当然响应可能没有以前及时，但也是近实时的。整体流程如下所示。<br><img src="/2018/09/29/基于规则的风控系统/处罚.png" alt=""><br>&emsp;&emsp;以上就是最近一段时间梳理的风控系统架构。目前只是对原有的逻辑进行拆分，为后期离线分析打下基础。后期会利用elasticsearch做一个超级cube的指标系统，参考平安spark+hive+es的方案，对用户历史行为轨迹做不同维度的分析。让业务方对用户更了解，逐步形成数据驱动风险策略的设定。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jinfei21.github.io/2018/09/22/从线性思维到系统思维/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="费永军">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金飞的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/22/从线性思维到系统思维/" itemprop="url">从线性思维到系统思维</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-22T19:21:02+08:00">
                2018-09-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/杂说/" itemprop="url" rel="index">
                    <span itemprop="name">杂说</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;最近从公司内部转岗到平台研发部，到现在已经有一个多月了。这一个多月一直在规划重构现有的风控系统，目前已经完成了第一期规划架构，正在coding阶段。得益于以前学到的系统思维理论，所以做这件事对我来说游刃有余，这期就聊聊这个理论，下期就聊我如何运用这个理论规划设计风控系统2.0的。<br>&emsp;&emsp;现实生活中有些问题很严重，虽然严重，但是简单。比如你最近头疼到医院就诊，医生首先要你去做一堆检测，首先搞清楚你是病毒性感冒还是病菌性感冒，然后才能对症下药，如果严重可能还要住院。像这种有明确因果关系的问题就是简单问题，他们的共同点就是有一个“因”，只要解决了这个因，问题也就解决了。<br>&emsp;&emsp;但是生活中除了这种简单的线性问题，有着明确因果关系外，还有着大量复杂问题，你很难定义明确的因果关系。前面我写过一篇博客谈论因果关系，有兴趣可以了解下前几期的文章。比如中国足球就是一个复杂问题，你要优化改革就不能简单的用线性思维来解决。比如你也知道，中国足球主教练，足协主席，裁判都换了个遍，可中国足球还是那样。像这种复杂问题是一个系统问题，不能简单的用线性思维来解决问题，你必须具有系统思维。<br>&emsp;&emsp;好，既然说到系统思维，那什么是系统呢？所谓系统，就是一个由很多部分组成的整体，各个部分互相之间有联系，作为整体又有一个共同的目的。人的身体、学校、公司、国家，都是系统。系统有三个特征。</p>
<blockquote>
<p>第一、系统里有各种元素，也就是各个部分。比如学校系统，其中有老师、有学生，有教室、有操场，这些元素是系统的组成部分。组成元素是一个系统最明显的东西，而也可能是最不重要的东西，因为它们常常是可替换的。正所谓铁打的营盘流水的兵，学生来了又走，老师、校长都可以换，而学校还是这个学校，系统还是这个系统。<br>第二、系统中各个元素之间，有各种关系。这些关系可以是上下级的命令、谁和谁合作、谁向谁汇报，也可以是规则、物理定律。元素可以随时调换，但关系通常是不变的。所以真正要理解一个系统的运行机制，你就要了解它的关系结构。<br>第三、系统还有一个功能，或者说是一个目的。比如学校的功能就是教育学生。系统的功能往往是不明显的，有时候表面上有个功能，实际上还有个功能。比如学校系统，表面上看，它的目的应该是教育学生；但实际上，它的目的也许是考试能力训练，或者纯粹是为了赚钱。</p>
</blockquote>
<p>&emsp;&emsp;系统经常出现问题就是目标不明确，而且有时候组成系统的各个部分的目标和系统总目标是不一致的。要想系统良性运行，必须要把目标协调统一好才行。你解决优化任何一个部分都不能圆满解决问题。<br>&emsp;&emsp;系统思维的反义词，是“线性思维”。所谓线性思维，就是简单明了的因果关系 —— 既然这有这么一个结果，就一定有一个原因，只要解决了原因就能解决问题。手机没电了，你去充电就行了。线性思维就是这么直来直去，适合我们一开头说的那些简单问题。不是说线性思维不行，而是线性思维有它适用的场合。<br>&emsp;&emsp;那有什么标准区分是线性问题还是系统问题呢？系统论的专家认为，如果出现以下症状，那这个问题恐怕不是线性问题，而是系统问题：</p>
<ul>
<li>看似是个小问题，但是要解决它却要耗费许多资源.</li>
<li>多次试图解决一个问题，却总是无效.</li>
<li>问题本来应该容易解决，可是人们故意不解决.</li>
<li>新人来了就发现问题，老人一笑了之.</li>
<li>类似的问题一再发生，整改了也没用……</li>
</ul>
<p>&emsp;&emsp;面对系统问题，没有什么快速解决的办法，也不是投入更多资源就能解决。解决系统问题的出发点，是你得抓住两个关键点。<br>&emsp;&emsp;一个概念是库存，也就是系统里面某种东西的保有量。库存可以是任何东西。比如夫妻感情系统，库存就是两个人共同积累了多少正面的感情。输入是互相之间亲密的表示，可以增加库存；输出是各种争吵和矛盾，会消耗情感库存。如果情感库存见底了，婚姻系统就很危险了。<br>&emsp;&emsp;一个概念叫反馈回路，反馈回路分为两种，它们是库存和输入输出之间的关系机制。<br>&emsp;&emsp;一种是正反馈回路，也叫自增强回路。所谓正反馈回路就是库存里的东西越多，输入就会越大，于是就会进一步增大库存。比如挣钱，就得靠正反馈回路。你的钱越多，投资产生的利润就越多；利润越多，你的钱又会进一步增多。投资 — 挣钱 — 投资，这就是一个正反馈回路。导致系统崩溃的往往也是某种正反馈回路。就比如夫妻关系，情感储备越少，看对方就越不顺眼；看对方越不顺眼就越容易发生冲突，结果就是情感储备进一步减少。这不是“正能量”，但是也是“正的”反馈 —— 因为有个叫愤怒的东西在<em>增长</em>。<br>&emsp;&emsp;一种是负反馈回路，也叫平衡回路。负反馈不等于负能量 —— “负”的意思是“减少”。当库存太多了，负反馈回路负责减少库存。比如国家看谁太富了就多收他点税，看谁太穷了就给他发点钱，家里看老婆情绪不对就赶紧哄哄，这都是负反馈回路。负反馈总是让系统回到“正轨”上来。<br>&emsp;&emsp;一个系统中可以有若干个正反馈和若干个负反馈回路。正反馈回路让系统或者增长、或者崩溃，是要偏离平衡；负反馈回路则尽力保持系统的平衡。<br>&emsp;&emsp;对你想要解决的这个问题而言，可能就有一个回路，正在起主导的作用。如果你能发现在系统里起主导作用的回路是什么，你就抓住了系统的主要矛盾，你就找到了问题的关键所在。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jinfei21.github.io/2018/09/15/鲁迅先生北漂的一点感想/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="费永军">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="金飞的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/15/鲁迅先生北漂的一点感想/" itemprop="url">鲁迅先生北漂的一点感想</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-15T15:07:37+08:00">
                2018-09-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/杂说/" itemprop="url" rel="index">
                    <span itemprop="name">杂说</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&emsp;&emsp;学生时代受学校教育的影响，对鲁迅学习的比较多，对其辛辣的文字和深刻的社会批判十分喜欢。如今在社会上打拼多年，可能是职业关系，我不太喜欢只谈问题不给方案的处理方式。渐渐的对鲁迅看的就不多了，相反对胡适的思想越来越推崇，其少谈主义多研究问题的态度比较契合我现在的风格。今天不聊鲁迅的思想，是聊鲁迅的北漂经历。</p>
<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>&emsp;&emsp;鲁迅原本是一个书香门第，也算是官三代。怎奈时运不济家道中落，在鲁迅小时候因为祖父的案件吃了官司，家庭的突然变故，也让小时候的鲁迅体会到了世态炎凉，估计是受了不少白眼，对鲁迅的人格朔造特别明显，成年以后性格特别坚韧文字特别刻薄。他两个弟弟当时还小，可能没有感受鲁迅体会到的人情冷漠，也造成三兄弟性格迥异。<br>&emsp;&emsp;因为童年的苦痛记忆，鲁迅小时候特别想出人头地，作为家中长子，必须当起这个家。在当时可能只有贫家子弟才去的学堂，鲁迅先生也去。甚至为了学费问题，去东渡日本留学。我们现在看东渡日本留学，可能是优秀的人才去，实际不是的。大部分都是家道中落，却想出人头地的那些家庭子弟才会去。但凡有条件的都不会去外国留学。<br>&emsp;&emsp;鲁迅先生其实去日本也没有好好学习获得一个正经的文凭。他的文章写的藤野先生，介绍了一段弃医从文的经历，实际他的医学成绩并不突出。只是在日本翻译了几本文学著作和朋友合办了几本杂志，还都没有挣到钱。最后在留学经费花完的情况下，才不得不回国谋个差事，一是家庭也需要他供养，二来日本也没有出路。我接下来要说的就是回国后鲁迅先生北漂的经历。<br>&emsp;&emsp;现在80后被高房价折腾的死去活来，年轻人要靠死工资在北上广一线城市买房简直太难太难了。鲁迅先生北漂也遇到这个坎。新任的教育部长蔡元培邀请同乡鲁迅共事，那个年代也没有说面试要文凭，凡是留过洋，即使是野鸡大学的，只要有朋友圈推荐都能获得一份差事。鲁迅先生就这样在老乡的推荐下，从浙江绍兴县城拎着个箱子来到大城市北京（当时他还是一个人民教师），就这样成为了一个光荣的科级公务员。<br>&emsp;&emsp;基层公务员工资也不高，家里也没有多余的钱接济他，相反这个时候他还要供养家庭和在日本留学的弟弟。每个月发完薪水寄给家人，剩下留给自己的就不多了。没办法，他只能在砍头集散地菜市口找了个隔断间，开始了自己的租房生活。<br>&emsp;&emsp;入住没多少天，他就后悔了。这个地方太脏了，蟑螂又大又黑，油光闪亮，一看就知道营养不错。最膈应的是床铺，一小时能逮30多只跳蚤。为了不被咬肿，鲁迅只能趴桌子上睡，第二天起床继续逮跳蚤。而且周围住的人也是鱼目混珠，各色人等都有。鲁迅被吵的神经衰弱，但是初来乍到，没钱换房，就这样鲁迅在这样的环境忍受生活了4年，你可以想象作为一个海外归国的高级知识分子的心理阴影。<br>&emsp;&emsp;有一次房东说，隔壁有个名叫「补树书屋」的三居室，是个凶宅，院子槐树上吊死过人，白送都没人住。鲁迅听到这个消息乐坏了，不多日，他就迅速搬进去了。终于有个安静的地方能向往诗和远方，夫复何求。他还专门跑到小商品市场琉璃厂买下4幅画，3个小摆设，合计10个大洋。回家迎着夕阳，感觉自己终于过上中产阶级生活，满脸小确幸。<br>&emsp;&emsp;新房唯一的缺点是猫叫太扰人，隔三差五的野猫调情，整晚闹得鲁迅睡不着，他抄起竹竿上去就打，但没过一会，几只野猫又浪回来了。好在凶宅风水不错，鲁迅的生活慢慢发生改变。<br>&emsp;&emsp;在单位作为新来的外地人也不受待见，老油条们尸位素餐，什么事也不干，鲁迅无奈下只好在家里喝茶、写文章，当个「佛系青年」，时不时的给新青年投稿。就这样，在他北漂第6年，他原创的白话小说《狂人日记》发表，当即成为轰动一时的爆文，各大媒体疯狂转发。连北大的李大钊和胡适都夸赞鲁迅的才华。<br>&emsp;&emsp;终于凶宅里默默码字的鲁迅，成为了北京城最著名的爆文大神，写一篇爆一篇，名气和稿费水涨船高，连北大学者钱玄同也来拜访。<br>&emsp;&emsp;随着名气见涨，鲁迅大名在老家广为流传，家里人纷纷过来投靠。一大家子住三居室肯定不够，加上这时候他经济状况也有好转，人出名了来钱也快，他决定买一个大房子。为了找房，只懂学术的鲁迅开始研究房价。彼时北京作为准一线城市，房价低于上海、广州、天津、南京。鲁迅存款不多，想找个地段好、户型好的房子仍是费劲。从东五环到西五环来回折腾半年，看了30多套，总算相中什刹海西北一套二手四合院。这里临近北大沙滩红楼，文化气息浓郁，符合鲁迅高级知识分子身份。南北通透， 适合老人孩子居住。30多间屋子，足以住下一大家子外加保姆、厨子、司机。<br>&emsp;&emsp;但房子总价3500大洋，拉黄包车的干30年也买不起。鲁迅托关系，找浙江兴业银行老乡贷了500大洋，卖了老家的房子，加上存款，总算全款买下。<br>&emsp;&emsp;北漂第7年，房子搞定了，鲁迅以为以后一家人会幸福的生活在一起，特意安排2个弟弟住主卧，自己住次卧。谁知道2个弟妹的生活日常就是作，厨子刚端上一盘日料，她们死活要吃饺子。没事就去买奢侈品，刷爆鲁迅好几张信用卡。住进新家不满一年，就把自家弟弟从日本接过来。<br>&emsp;&emsp;作，也就算了，最可怕的是家庭关系不和谐。鲁迅偶尔提醒几句，俩姑娘就能到自己老公那挑拨离间，一大家子鸡飞狗跳。纯种直男鲁迅根本应付不了，气得饭也不和他们吃，天天闷在小房里。没过多久，鲁迅受不了家里鸡毛蒜皮，搬出去租房。中途回家拿书，本想找二弟聊聊。结果周作人说他小家子气，跟女人计较，把鲁迅的书扔一地，还拿鲁迅的古玩砸他。鲁迅怒了，抄起瓷枕就反击。<br>&emsp;&emsp;最终，鲁迅和弟弟全家绝交，带着母亲和童养媳净身出户。他在西四环的砖塔胡同租了个破开间，晚上睡觉连门都关不上，冬天把老婆冻得直哆嗦。只好找两个朋友各借400大洋在西二环阜成门的城中村，买了套小四合院。安顿好母亲和老婆，身无分文的鲁迅又背上800大洋的房贷，这钱他2年后离开北京也没还完。为了早日还款，鲁迅连着在北大和北师大教书，2份兼职加上正职工作让他在西单、北大、阜成门之间来回跑，每天少说3、4小时在路上。<br>&emsp;&emsp;北漂14年，从30到44岁间鲁迅经历了租房、买房、还房贷各种辛酸。在他从县城教师变成新文化运动的开创者，思想先驱，背后就是一地鸡毛。</p>
<h2 id="感想"><a href="#感想" class="headerlink" title="感想"></a>感想</h2><p>&emsp;&emsp;鲁迅先生北漂这段经历可以看出，先生的生活也不轻松。生活从来就不是轻松的，没有哪一代人是容易的，生活从来不是一件简单的事。现代社会相比鲁迅时代确实要先进很多，各种资讯也很发达，但是很容易就淹没在信息的海洋，你读不到真正的智慧。就比如我身处的P2P行业，我就真搞不懂那些借钱消费的都是些什么人？年轻本是挣钱的年纪，你可以挣多少花多少，量力而为，怎么还能借钱消费呢？人的欲望是无穷的。虽然现在财富的增长可以是指数级的，不像过去是线性增长，如果考虑人口比例，能享受财富指数级增长的毕竟是塔尖那部分少数人群。不过也没有什么好抱怨的，人类社会的演化法则就是这样。大部分可以大概率的预期自己将来不会有大的财富和阶层变化，认识到这点你就应该适时调整自己的行为方式，相反你能更容易获得幸福。而如果你报着不切实际的幻想，大概率你会很痛苦，当然你可以说你有梦想，会不会成功？当然会成功，但是成功毕竟是一个偶然事件。一个人一生能在晚年有一个幸福的家庭已经很了不起了，有时不必对自己过于苛刻。有位哲人曾经说过，人生不在你取得了多大的成功，而在于你经历了多少事情提升了多少维度。<br>&emsp;&emsp;再拉回到现实，我身处P2P行业，我很清楚这行对小年轻意味着什么。当金融资本开始对屌丝阶层进行收割时，说明这个时代真的留给年轻人的机会不多。那这群花未来钱进行透资消费的小年轻，等到将来他们老的那天谁来养他们？难道像日本现在的年轻人一样做一个佛系青年，整个社会透着无欲望的下流氛围？这是我们80后90后未来必须要面对的一个社会问题。我是从农村走向城市，从小就有个根深蒂固的观念任何事情都有代价，你要想获得必须首先付出，这份付出还包含着未来不确定性的高风险。罗永浩曾经说过，年轻人就应该在年轻的时候把挣的钱花掉，不要年纪轻轻想着存钱，要相信未来会挣大钱。我对这句话也深表认同，前提是你是否准备好付出代价，你是否能像罗永浩一样足够牛逼。所以人合理认识自己很重要，这样你就能把握一个度的问题。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">费永军</p>
              <p class="site-description motion-element" itemprop="description">简单靠谱，追求自由</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">35</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">23</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/jinfei21" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:63581560@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.ruanyifeng.com" title="阮一峰" target="_blank">阮一峰</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://skyao.io/" title="敖小剑" target="_blank">敖小剑</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.yinwang.org" title="王垠" target="_blank">王垠</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.liaoxuefeng.com" title="廖雪峰" target="_blank">廖雪峰</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.codingnow.com" title="云风" target="_blank">云风</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://hui-wang.info" title="王辉" target="_blank">王辉</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://home.wangjianshuo.com/cn" title="王建硕" target="_blank">王建硕</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://hellojava.info" title="hellojava" target="_blank">hellojava</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.longquanzs.org/" title="龙泉之声" target="_blank">龙泉之声</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://wallstreetcn.com/" title="华尔街见闻" target="_blank">华尔街见闻</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.zybuluo.com/mdeditor" title="markdown" target="_blank">markdown</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">费永军</span>

  
</div>

<!--

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>

-->



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user">访客数</i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye">阅读数</i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('-1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  

</body>
</html>
